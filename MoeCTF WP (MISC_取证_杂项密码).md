# MISC
## Misc入门指北
```
文章末尾 : bW9lY3Rme2hAdjNfZnVuX0B0X20xNWNfIX0=
base64 : moectf{h@v3_fun_@t_m15c_!}
```
## 打不开的图片1
下载附件修复头文件（插入FF D8）
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692016959632-e57eab8a-0db2-4ae6-a1be-b341b9d28cbb.png#averageHue=%23393732&clientId=u97f8c1fa-0c2d-4&from=paste&height=1039&id=ud4c90767&originHeight=1039&originWidth=1220&originalType=binary&ratio=1&rotation=0&showTitle=false&size=122205&status=done&style=none&taskId=u09bf45bc-9f18-4a5b-a9bd-d1800573ddc&title=&width=1220)
文件后缀添加'.jpg'
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692017088120-8881578b-f09a-44e7-85c0-7c6030d12924.png#averageHue=%23f6f5f4&clientId=u97f8c1fa-0c2d-4&from=paste&height=658&id=ub6cddb76&originHeight=658&originWidth=435&originalType=binary&ratio=1&rotation=0&showTitle=false&size=38246&status=done&style=none&taskId=u14a5d6d9-ac13-41be-bb02-0a2bcb49180&title=&width=435)
```
文档属性：6d6f656374667b5844555f69355f763372795f3665407532696675317d
from hex : moectf{XDU_i5_v3ry_6e@u2ifu1}
```
## 打不开的图片2
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692017185554-e89fe262-1aad-4c82-a293-fec613a2f949.png#averageHue=%23393732&clientId=u97f8c1fa-0c2d-4&from=paste&height=1039&id=u57ddb519&originHeight=1039&originWidth=1220&originalType=binary&ratio=1&rotation=0&showTitle=false&size=250678&status=done&style=none&taskId=u19b2ee3d-3c91-420e-a9b6-49c4358cf9a&title=&width=1220)
修复头文件从JPG到PNG（89 50 4E 47）
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692017386615-700cf3b1-e1c6-4089-8489-bd797853cae9.png#averageHue=%23d1d7cb&clientId=u97f8c1fa-0c2d-4&from=paste&height=603&id=u65172477&originHeight=603&originWidth=1073&originalType=binary&ratio=1&rotation=0&showTitle=false&size=681811&status=done&style=none&taskId=ua8ff61b9-c394-4830-a3ba-b6826b647bc&title=&width=1073)
```
moectf{D0_yOu_1ik3_Bo7@k_?}
```
## 狗子(1)普通的猫猫
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692017665131-fd30dce7-be78-411b-a7fb-724a0ef5f1c6.png#averageHue=%233d3c35&clientId=u97f8c1fa-0c2d-4&from=paste&height=1039&id=uf8c21610&originHeight=1039&originWidth=1220&originalType=binary&ratio=1&rotation=0&showTitle=false&size=159387&status=done&style=none&taskId=uc5078e1a-ee50-42d3-b13e-f82495c093b&title=&width=1220)
```
文件末尾：moectf{eeeez_f1ag_as_A_G1ft!}
```
## building_near_lake
![image.jpg](https://cdn.nlark.com/yuque/0/2023/jpeg/35229002/1692084886067-789662ea-a4ee-4362-8acc-2fd8303b810d.jpeg#averageHue=%23897338&clientId=u4936205f-0815-4&from=paste&height=1440&id=u7fd06661&originHeight=1440&originWidth=3200&originalType=binary&ratio=1&rotation=0&showTitle=false&size=886096&status=done&style=none&taskId=ue4b379bc-9d08-4255-8030-038b350a0da&title=&width=3200)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692084896790-2633b1ff-3242-4ff8-91de-11ac11e534ad.png#averageHue=%23f6f5f4&clientId=u4936205f-0815-4&from=paste&height=658&id=u85146ae8&originHeight=658&originWidth=435&originalType=binary&ratio=1&rotation=0&showTitle=false&size=39941&status=done&style=none&taskId=ud0eeda35-ac6f-43ac-aa33-8d255aec204&title=&width=435)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692084929711-1d637c70-9585-4e27-b016-8fbe53026c66.png#averageHue=%23fbfaf9&clientId=u4936205f-0815-4&from=paste&height=404&id=u41473557&originHeight=404&originWidth=695&originalType=binary&ratio=1&rotation=0&showTitle=false&size=46869&status=done&style=none&taskId=u5fc15a5d-719e-4b1e-8b0f-e1364afa2c3&title=&width=695)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692084946173-5de6899a-592f-440f-8867-a6a1bee36238.png#averageHue=%23f7f6f4&clientId=u4936205f-0815-4&from=paste&height=441&id=u51910c45&originHeight=441&originWidth=670&originalType=binary&ratio=1&rotation=0&showTitle=false&size=48156&status=done&style=none&taskId=u39dbda86-74fa-451a-83f9-0f4f6fe0fe5&title=&width=670)

发布会时间：20221227

![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692084987709-a3adbbac-cb8b-4577-9028-53ab176e396b.png#averageHue=%23bebcbb&clientId=u4936205f-0815-4&from=paste&height=656&id=u0993a92f&originHeight=656&originWidth=1166&originalType=binary&ratio=1&rotation=0&showTitle=false&size=112156&status=done&style=none&taskId=u75cf4416-c90a-4d26-80f5-a485c476a06&title=&width=1166)

![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692085000431-1f01f169-fc59-491a-80bc-cee8f82c8d51.png#averageHue=%23241f25&clientId=u4936205f-0815-4&from=paste&height=157&id=u61009ee8&originHeight=157&originWidth=398&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15213&status=done&style=none&taskId=u4c91eb86-fc75-402e-a7ad-c0c28a43831&title=&width=398)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692085019895-4a5b01cf-296b-4dea-99fc-48c76c531fea.png#averageHue=%232d1b0e&clientId=u4936205f-0815-4&from=paste&height=236&id=ue4503ca6&originHeight=236&originWidth=521&originalType=binary&ratio=1&rotation=0&showTitle=false&size=155565&status=done&style=none&taskId=u1bec12cb-c111-47d1-8e20-dc0d8929578&title=&width=521)
根据XMU 翔安 图书馆，可以搜到是厦门大学翔安校区的德旺图书馆
在地图上能找到此地，但是不确定拍摄的门是在哪里
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692085216940-ea7fcbe7-95a7-4800-9f76-25442948256e.png#averageHue=%23caeee5&clientId=u4936205f-0815-4&from=paste&height=662&id=u7df9d026&originHeight=662&originWidth=640&originalType=binary&ratio=1&rotation=0&showTitle=false&size=179786&status=done&style=none&taskId=uc0aa3a2e-22df-47f6-a3f1-4647fb3110b&title=&width=640)

搜索可以发现是靠湖那边
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692085156716-04776a50-d3cf-4fb4-97a0-c0da0b15493c.png#averageHue=%23636963&clientId=u4936205f-0815-4&from=paste&height=802&id=ub3cfd635&originHeight=802&originWidth=1063&originalType=binary&ratio=1&rotation=0&showTitle=false&size=506372&status=done&style=none&taskId=u7e8275fc-3b68-4ab5-a044-3b2a43e9084&title=&width=1063)
由于范围只精确三位小数，红圈内的经纬度相同
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692085337227-8466d55a-ee74-4b4d-aa2f-fe0708490cba.png#averageHue=%23e6efda&clientId=u4936205f-0815-4&from=paste&height=607&id=u7b66ce1f&originHeight=607&originWidth=614&originalType=binary&ratio=1&rotation=0&showTitle=false&size=95584&status=done&style=none&taskId=u5a69ef5e-a2ab-46a7-8a7b-ed98e514cb7&title=&width=614)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692085547264-3d2f27a6-9e57-41d1-ab58-d723111ff52a.png#averageHue=%23e9e6e2&clientId=u4936205f-0815-4&from=paste&height=511&id=u2a518c26&originHeight=511&originWidth=990&originalType=binary&ratio=1&rotation=0&showTitle=false&size=123184&status=done&style=none&taskId=u2dc3c937-472e-4f65-8f62-42a3c60a5a0&title=&width=990)
```
moectf{P0sT_Y0uR_Ph0T0_wiTh_0Riginal_File_is_n0T_a_g00d_idea_YlJf!M3rux}
```
## 烫烫烫
```
+j9k-+Zi8-+T2A-+doQ-flag+/xo-+AAo-+AAo-a9736d8ad21107398b73324694cbcd11f66e3befe67016def21dcaa9ab143bc4405be596245361f98db6a0047b4be78ede40864eb988d8a4999cdcb31592fd42c7b73df3b492403c9a379a9ff5e81262+AAo-+AAo-+T0Y-+Zi8-flag+dSg-AES+UqA-+W8Y-+ToY-+/ww-key+Zi8-+Tgs-+l2I-+j9k-+iEw-+W1c-+doQ-sha256+/wg-hash+UDw-+doQ-+XwA-+WTQ-+Zi8-b34edc782d68fda34dc23329+/wk-+AAo-+AAo-+YkA-+TuU-+i/Q-+/ww-codepage+dx8-+doQ-+X4g-+kc0-+iYE-+VUo-+/wg-+AAo-
```
根据题目的提示（锟斤拷是编码转换的问题）使用cyberchef的编码转换尝试
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692018954027-42ab2a23-f4a1-497c-8b1a-d3bace1d4c2b.png#averageHue=%23dfe7ca&clientId=u97f8c1fa-0c2d-4&from=paste&height=816&id=ud9a1e5b4&originHeight=816&originWidth=1501&originalType=binary&ratio=1&rotation=0&showTitle=false&size=111067&status=done&style=none&taskId=u20074270-3c94-46e5-b180-1cf0e9b1ca3&title=&width=1501)
```
UTF8 --> UTF 7
```
再进行AES解密
```
key:
所以说，codepage真的很重要啊（ --> SHA256 b34edc782d68fda34dc2332967273b0f0900a0ebd0dcec48467851bc6117bad1
```
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692019277354-260f446f-e372-403f-99f3-7aa137fea3ff.png#averageHue=%23deebd1&clientId=u97f8c1fa-0c2d-4&from=paste&height=1001&id=ub637126a&originHeight=1001&originWidth=1515&originalType=binary&ratio=1&rotation=0&showTitle=false&size=127274&status=done&style=none&taskId=ubc13df41-eccf-486c-9b3d-baee14f9090&title=&width=1515)
```
moectf{codep@ge_pl@ys_@n_iMport@nt_role_in_intern@tion@liz@tion_g92WPIB}
```
## 狗子(2)照片
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692018377645-1c168cc7-334e-4607-9e74-316c37edd6fa.png#averageHue=%23232e3c&clientId=u97f8c1fa-0c2d-4&from=paste&height=599&id=udad9774f&originHeight=599&originWidth=788&originalType=binary&ratio=1&rotation=0&showTitle=false&size=194437&status=done&style=none&taskId=u390a2db4-9b87-4e3b-bf49-b89c4e7fd9d&title=&width=788)
```
LSB隐写，使用Zsteg工具
zsteg -a /root/Desktop/bincat_hacked.png   
moectf{D0ggy_H1dd3n_1n_Pho7o_With_LSB!}
```
## Base乐队
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692019351483-e5d99875-4b9d-4156-b890-4329e0a4540b.png#averageHue=%23deedd3&clientId=u97f8c1fa-0c2d-4&from=paste&height=1001&id=u174deb53&originHeight=1001&originWidth=1515&originalType=binary&ratio=1&rotation=0&showTitle=false&size=118141&status=done&style=none&taskId=ub427a984-437d-42a5-8fcb-b1c2215b211&title=&width=1515)
```
HFUEULC5HEZG42DGHFGDWSCTHRCUIUSVHFGDWS2EGZMCCRDKG5XG2LDEHFUTYYZGHJSUMKKDGVZDELBRHBIW4UCQGZLGOP2SHEYV44ZOHEZFYXCZHEYUIV2VGEXVK4KRHBWFWY2OHVMWSYCKG5XFCZTBHEZC6I2WHJST2ZK4HEXTSMDSHA3CKZRZGRNHI4LL

base32:9hJ,]92nhf9L;HS<EDRU9L;KD6X!Dj7nm,d9i<c&:eF)C5r2,18QnPP6Vg?R91^s.92\\Y91DWU1/UqQ8l[cN=Yi`J7nQfa92/#V:e=e\9/90r86%f94Ztqk

base85:MJMWKTSRLBMVUWDCLBNFCZSXGMYUMR32PJCDA3JQIZEFCOKSKI4DKRSGKFMU2QRZJU6WY3LPGJVXKMJRPIYHK2L2HU======

base32:bYeNQXYZXbXZQfW31FGzzD0m0FHQ9RR85FFQYMB9M=lmo2ku11z0uiz=

W型栅栏密码 key=4:bW9lY3Rme1RoNF82QG5kXzFuYzF1ZDQ1X0YzbmM0X0BuZF9iQHMzfQ==

base64:moectf{Th4_6@nd_1nc1ud45_F3nc4_@nd_b@s3}
```
## 奇怪的压缩包
### part_1:
字体颜色被改白了
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692101076690-66c84fd4-50e8-453c-b077-04583e7e384f.png#averageHue=%23e6cea8&clientId=u1637c5bd-9039-4&from=paste&height=1032&id=u647acebe&originHeight=1032&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=148928&status=done&style=none&taskId=u9eebb50e-4468-4463-b70e-2efa678106b&title=&width=1920)
### part2:
备注
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692101103415-726588ec-a44e-4de2-9b6a-a8022220775d.png#averageHue=%235bbb94&clientId=u1637c5bd-9039-4&from=paste&height=147&id=u41b9d745&originHeight=147&originWidth=249&originalType=binary&ratio=1&rotation=0&showTitle=false&size=41136&status=done&style=none&taskId=u06e08df3-2b0e-47ad-b2df-91d51803bed&title=&width=249)
### part3:
ppt以zip文件格式打开，在 slide 目录中存储着 ppt 单张幻灯片数据
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692101145936-aa91cab9-21c6-43e6-adeb-cde8b633edf9.png#averageHue=%23fefdfd&clientId=u1637c5bd-9039-4&from=paste&height=215&id=u1ed709ad&originHeight=215&originWidth=563&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5850&status=done&style=none&taskId=u84b0d2d0-28d1-4cbb-9de0-e5a39fb6ee2&title=&width=563)
```
moectf{2ip_?_n0_i4_pp4x!}
```
## 机位查询
### 1.jpg
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692086692232-3775fb65-350e-4d59-ae46-996631da4180.png#averageHue=%235b4c42&clientId=u4936205f-0815-4&from=paste&height=766&id=u9637f7f5&originHeight=766&originWidth=1089&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1077839&status=done&style=none&taskId=ub73c69a8-c380-43b0-9d34-92bb1142056&title=&width=1089)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692086772876-d4ba48ea-d869-4460-b509-2ffe0ac3213c.png#averageHue=%23686151&clientId=u4936205f-0815-4&from=paste&height=669&id=u9d63c8bf&originHeight=669&originWidth=1048&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1266064&status=done&style=none&taskId=ue39526ea-fedc-4709-8c1b-a35a2c1966b&title=&width=1048)
```
摩根快捷酒店(南宁火车站店)
广西壮族自治区南宁市兴宁区苏州路8号嘉士摩根大厦11楼
嘉士摩根大厦:jiashi
```
### 2.jpg
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692086890648-10f6efe6-c328-42db-be69-ed8785c2d484.png#averageHue=%236a7573&clientId=u4936205f-0815-4&from=paste&height=162&id=ud1e7a1bb&originHeight=162&originWidth=361&originalType=binary&ratio=1&rotation=0&showTitle=false&size=149703&status=done&style=none&taskId=uff1c9e57-372a-40af-b904-8cda7b658af&title=&width=361)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692086940065-23142138-3c61-40fd-ac25-26e45bab174a.png#averageHue=%23615e4d&clientId=u4936205f-0815-4&from=paste&height=620&id=u380c08e2&originHeight=620&originWidth=609&originalType=binary&ratio=1&rotation=0&showTitle=false&size=694915&status=done&style=none&taskId=u7a040119-22bc-46e7-91ef-113aab3c222&title=&width=609)
```
城市便捷酒店
广西壮族自治区南宁市兴宁区朝阳路9号百盛步行街广场办公区8楼
百盛步行街广场办公楼:baisheng
```
### 3.jpg
图片为原图，图片属性中有信息
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692087098906-d01e6463-d89a-432b-ad47-3894c70586fe.png#averageHue=%23f5f4f2&clientId=u4936205f-0815-4&from=paste&height=1040&id=u42a0013a&originHeight=1040&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=352389&status=done&style=none&taskId=u8fb7b0b0-18e8-4188-b8f7-1e7e7447a92&title=&width=1920)
```
汇金苑:huijin
```
拼接得到flag
```
moectf{jiashi_baisheng_huijin}
```
## 狗子(3)寝室
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692020125546-d043381a-25fb-468f-9d51-56cdadc378cc.png#averageHue=%23ead2a9&clientId=u97f8c1fa-0c2d-4&from=paste&height=389&id=u4db2a48a&originHeight=389&originWidth=455&originalType=binary&ratio=1&rotation=0&showTitle=false&size=57786&status=done&style=none&taskId=u25034d29-95b6-465d-91c8-f9f9ab47ae3&title=&width=455)
下载附件发现是循环压缩包套娃，写出循环解压缩包脚本即可
```python
import tarfile
import zipfile
import py7zr
import os

path = 'C:\\Users\\HK\\Desktop\\ziploop\\'


def extract_tar(filename):
    with tarfile.open(path + filename, 'r:gz') as tar:
        tar.extractall(path)
        return tar.getnames()[0]


def extract_zip(filename):
    with zipfile.ZipFile(path + filename, mode='r') as zipf:
        zipf.extractall(path)
        return zipf.namelist()[0]


def extract_7z(filename):
    with py7zr.SevenZipFile(path + filename, mode='r') as z:
        z.extractall(path)
        return z.getnames()[0]

last_filename = 'shell9999.tar.gz'

while True:
    first_filename = last_filename
    file_type = first_filename.split('.')[-1]

    if file_type == 'gz':
        last_filename = extract_tar(first_filename)
        os.remove(path + first_filename)
        continue

    if file_type == 'zip':
        last_filename = extract_zip(first_filename)
        os.remove(path + first_filename)
        continue

    if file_type == '7z':
        last_filename = extract_7z(first_filename)
        os.remove(path + first_filename)
        continue

```
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692020308695-50e4e049-55c8-434e-afa0-d26b87dd0341.png#averageHue=%23d6d6d6&clientId=u97f8c1fa-0c2d-4&from=paste&height=976&id=ue23b02b0&originHeight=976&originWidth=1526&originalType=binary&ratio=1&rotation=0&showTitle=false&size=100465&status=done&style=none&taskId=u48978c69-6d3a-4227-b519-6f58f65e2e9&title=&width=1526)
```
moectf{Ca7_s133p1ng_und3r_zip_5hell5}
```
## 你想要flag吗
下载得到一个音频文件，查看频谱得到key
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692020415465-ab35c33b-d00a-4c26-85a4-bad85744914c.png#averageHue=%23879da8&clientId=u97f8c1fa-0c2d-4&from=paste&height=714&id=ua4ffa047&originHeight=714&originWidth=940&originalType=binary&ratio=1&rotation=0&showTitle=false&size=570062&status=done&style=none&taskId=u77bd3df3-46e6-4f4c-8a96-8a95fa3ad71&title=&width=940)后面解rabbit的时候询问了出题人得知是有两个key的，如果key显示不全则需要提高频率
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692020509410-71c0ed2b-c17c-417c-a3e9-3c2e925e969b.png#averageHue=%23a2d29b&clientId=u97f8c1fa-0c2d-4&from=paste&height=714&id=u515aee5a&originHeight=714&originWidth=940&originalType=binary&ratio=1&rotation=0&showTitle=false&size=333214&status=done&style=none&taskId=u8453de7c-0d69-4531-a901-b7b0104a354&title=&width=940)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692020519005-0e59f61a-68be-4327-a3e8-63aa83e01768.png#averageHue=%238c9fa9&clientId=u97f8c1fa-0c2d-4&from=paste&height=714&id=u71b17541&originHeight=714&originWidth=940&originalType=binary&ratio=1&rotation=0&showTitle=false&size=518913&status=done&style=none&taskId=ufce66e54-d2e1-4303-8883-0ea0432fa76&title=&width=940)
根据pwd 进行Steghide解密
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692020647383-12b85dc6-4ed9-4e49-b64c-885db5d5c3c9.png#averageHue=%23262e3d&clientId=u97f8c1fa-0c2d-4&from=paste&height=130&id=ua0538fd0&originHeight=130&originWidth=398&originalType=binary&ratio=1&rotation=0&showTitle=false&size=15312&status=done&style=none&taskId=u022de35e-bbf0-4188-a8bc-4eacdfcee24&title=&width=398)
解出一个兔兔.txt，说明是rabbit加密
```
rabbit:U2FsdGVkX18pGLCTMBSjkndoY4gf2lbG96QwOzVZDZeAYOA+TKnfv1mCtQ==
key:Bulbasaur
m:Mu5ic_1s_v3ry_1nt23esting_!
```
## 照片要冲洗
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692021180780-39ea363d-fc2f-41ac-bfa5-25f66fb926f8.png#averageHue=%233d3b35&clientId=u97f8c1fa-0c2d-4&from=paste&height=1039&id=u86fb82db&originHeight=1039&originWidth=1220&originalType=binary&ratio=1&rotation=0&showTitle=false&size=207068&status=done&style=none&taskId=uf9147c27-927b-4aa7-95db-34028b561be&title=&width=1220)
将另一部分提取出来并修补PNG头
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692021297537-6651b02d-61e6-4905-ad4e-bcefe4209374.png#averageHue=%233a3932&clientId=u97f8c1fa-0c2d-4&from=paste&height=1039&id=u06a8c198&originHeight=1039&originWidth=1220&originalType=binary&ratio=1&rotation=0&showTitle=false&size=258524&status=done&style=none&taskId=u40159461-3e81-4d79-b5aa-180370bef7a&title=&width=1220)
会发现两张一样的图
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692021325491-5c1d1719-ccb0-4e7b-af43-16b84dd48682.png#averageHue=%2398a5a8&clientId=u97f8c1fa-0c2d-4&from=paste&height=60&id=u1f9c9363&originHeight=60&originWidth=158&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4185&status=done&style=none&taskId=u9e445716-e734-48ae-8203-b5b284eba2a&title=&width=158)
进行python3频域盲水印提取出图片
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692021397636-0f3d3ecd-2427-4015-97ef-5fc42cc37028.png#averageHue=%23f9f9f9&clientId=u97f8c1fa-0c2d-4&from=paste&height=759&id=u60e15af2&originHeight=759&originWidth=766&originalType=binary&ratio=1&rotation=0&showTitle=false&size=32542&status=done&style=none&taskId=u1ce07861-e05c-4ccd-b72b-e62a0fb8d32&title=&width=766)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692021413275-1bb6c8d0-35b0-4e96-be15-83a7f85d70ba.png#averageHue=%230e0e0e&clientId=u97f8c1fa-0c2d-4&from=paste&height=136&id=u6a98937b&originHeight=136&originWidth=993&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33122&status=done&style=none&taskId=u48d40573-327d-4239-ae96-47209dc7b79&title=&width=993)
手动调色 (反色，拉高对比度)
![IR1}9E5UWGH680]UQ`KKTAJ.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692021496844-7b8dee9b-bb17-441f-9430-b60c176da25b.png#averageHue=%23919191&clientId=u97f8c1fa-0c2d-4&from=paste&height=133&id=u29f5500d&originHeight=133&originWidth=748&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20150&status=done&style=none&taskId=u9706b175-fd1c-4055-8f65-eca8d968172&title=&width=748)
```
moectf{W0w_you_6@v3_1earn3d_blind_w@t3rma2k}
```
## 家乡话
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692021572316-875d7fc9-a430-452f-8be9-18f98536e6c3.png#averageHue=%23f3f1f0&clientId=u97f8c1fa-0c2d-4&from=paste&height=709&id=ud23f3261&originHeight=709&originWidth=1411&originalType=binary&ratio=1&rotation=0&showTitle=false&size=34358&status=done&style=none&taskId=u074705f6-3e04-4dc7-89a4-ed36dd2d281&title=&width=1411)
将False 改为0，将True改为1会直观很多
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692021633743-ea8f88b6-6f50-46fa-921f-d6fb13c145ae.png#averageHue=%23f4f3f2&clientId=u97f8c1fa-0c2d-4&from=paste&height=356&id=u67d80da1&originHeight=356&originWidth=1184&originalType=binary&ratio=1&rotation=0&showTitle=false&size=14533&status=done&style=none&taskId=u0580d6fe-4848-477b-9b47-7fac86eab55&title=&width=1184)
将其转为图片
```python
from PIL import Image

im = Image.new('RGB',(60,7),'white')

with open('./attachment.txt','r')as f:
    lines = f.readlines()
    for y in range(len(lines)):
        data = lines[y].split(' ')
        for x in range(len(data)):
            if data[x] == '1':
                im.putpixel((x,y),(0,0,0))

im = im.resize((60*5,7*5))
im.show()
```
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692021709085-d9f27c36-ed56-49db-9d7c-11e36aab1894.png#averageHue=%23d7d7d7&clientId=u97f8c1fa-0c2d-4&from=paste&height=35&id=u698334f6&originHeight=35&originWidth=300&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9390&status=done&style=none&taskId=u5efa3f81-f593-4949-9943-ec3b3e189f4&title=&width=300)
进行谷歌识图
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692021761679-16ca91d2-0d73-4623-b6d5-e7d4afa69336.png#averageHue=%23abceb1&clientId=u97f8c1fa-0c2d-4&from=paste&height=1001&id=u18c73729&originHeight=1001&originWidth=1515&originalType=binary&ratio=1&rotation=0&showTitle=false&size=242832&status=done&style=none&taskId=udbc6f75a-838f-473d-b2ff-8fe1256dc58&title=&width=1515)
发现字体为 minecraft enchantment Regular
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692021885404-20cd56ff-bd86-4d4e-8f80-08005fc1b81e.png#averageHue=%23ededed&clientId=u97f8c1fa-0c2d-4&from=paste&height=236&id=uf23a9fc5&originHeight=236&originWidth=1188&originalType=binary&ratio=1&rotation=0&showTitle=false&size=67957&status=done&style=none&taskId=ue434ddff-4324-4b46-a12d-5dd7f86af58&title=&width=1188)
根据码表得到 dontanswer
```python
moectf{dontanswer}
```
## weird_package
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692101256790-5141ecc0-21eb-4b9e-9034-27172e0f3dd7.png#averageHue=%23d9b371&clientId=u1637c5bd-9039-4&from=paste&height=488&id=u42c5a3b6&originHeight=488&originWidth=756&originalType=binary&ratio=1&rotation=0&showTitle=false&size=57659&status=done&style=none&taskId=uc89a6eb3-dd69-49c0-a7a3-647bddd61fd&title=&width=756)
```python
import base64
import zlib

# list = [9, 4, 5, 2, 1, 3, 6, 8, 7]
list = [1, 2, 3, 4, 5, 6, 7, 8, 9]
data = b''

with open('./3', 'r') as f:
    lines = f.readlines()

    for num in list:
        data += base64.b64decode(lines[num - 1])

with open('out','wb')as f:
    f.write(data)
```
其中有很多base64格式文件，解码后拼接可以得到数据流文件
将数据流文件直接压缩成新文件（一般直接压缩是store压缩方式，其中的数据直接嵌入在zip数据中），
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692101549958-ed9e280d-ce70-4ffe-83de-f7ecbe8efe34.png#averageHue=%233e3c36&clientId=u1637c5bd-9039-4&from=paste&height=1022&id=u52a9f1e8&originHeight=1022&originWidth=998&originalType=binary&ratio=1&rotation=0&showTitle=false&size=208618&status=done&style=none&taskId=u5736fd08-b63c-478c-9241-08acbf9fb62&title=&width=998)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692101555952-c137dce9-6bbe-4fd8-9960-918e24e3321e.png#averageHue=%233a3934&clientId=u1637c5bd-9039-4&from=paste&height=1022&id=ud94f82d4&originHeight=1022&originWidth=998&originalType=binary&ratio=1&rotation=0&showTitle=false&size=264969&status=done&style=none&taskId=u782276b3-def3-41db-9000-477b50d93de&title=&width=998)
以上为两数据比较

但是压缩流方式不是明显的 flag ，被其它压缩算法压缩，查看原a.zip 发现是COMP_DEFLATE (8) 算法
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692101637363-3d3f594f-0291-4391-a804-c1107bb7de9e.png#averageHue=%233f3d38&clientId=u1637c5bd-9039-4&from=paste&height=194&id=udd4558a9&originHeight=194&originWidth=700&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17665&status=done&style=none&taskId=u5c2ac219-ae93-4c76-8b9e-70c0a772097&title=&width=700)
将压缩出的新文件更改算法，解压（会CRC报错，但是还是能够直接解压的）
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692101735124-c6ce86e4-4b66-49a1-92cc-a66d3abebf61.png#averageHue=%233e3c37&clientId=u1637c5bd-9039-4&from=paste&height=244&id=u234099cd&originHeight=244&originWidth=748&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28049&status=done&style=none&taskId=uc170e872-b294-4287-b036-a1775976933&title=&width=748)
```
两种数据流排列方式得到的数据

out_name
bW9lY3Rme3dvd190SGlzX2lzX2FfZmFLZV9mTGFHX0hhSGFIYV9TNjZpbERNVjNEY2lZZiFsUDBpWWxKZiFNM3J1eDlHOVZ9Cg==
base64:moectf{wow_tHis_is_a_faKe_fLaG_HaHaHa_S66ilDMV3DciYf!lP0iYlJf!M3rux9G9V}

out_time
bW9lY3Rme1dIYVRfRGlEX1lvdV9Eb19Ub19USGVfYXJjSGl2ZT9fIWxQMGlZbEpmIU0zcnV4OUc5VmYhSm94aU1sOTAzbGx9
moectf{WHaT_DiD_You_Do_To_THe_arcHive?_!lP0iYlJf!M3rux9G9Vf!JoxiMl903ll}

name排列为fake flag，time排列为真flag
moectf{WHaT_DiD_You_Do_To_THe_arcHive?_!lP0iYlJf!M3rux9G9Vf!JoxiMl903ll}
```
# 古典密码
## ezrot
```
>@64E7LC@Ecf0:D0;FDE020D:>!=60=6EE6C0DF3DE:EFE:@?04:!96C0tsAJdEA6d;F}%0N

根据题目名称可知是Rot位移

rot47:moectf{rot47_is_just_a_simPle_letter_substitution_ciPher_EDpy5tpe5juNT_}
```
## 可可的新围墙
```
mt3_hsTal3yGnM_p3jocfFn3cp3_hFs3c_3TrB__i3_uBro_lcsOp}e{ciri_hT_avn3Fa_j

根据题目名称可知是栅栏密码

moectf{F3nc3_ciph3r_shiFTs_3ach_l3TT3r_By_a_Giv3n_nuMB3r_oF_plac3s_Ojpj}
```
## 皇帝的新密码
```
tvljam{JhLzhL_JPwoLy_Pz_h_cLyF_zPtwPL_JPwoLy!_ZmUVUA40q5KbEQZAK5Ehag4Av}

维吉尼亚密码 key=h:
moectf{CaEsaE_CIphEr_Is_a_vErY_sImpIE_CIphEr!_SfNONT40j5DuXJSTD5Xatz4To}
```
## 不是皇帝的新密码
```
scsfct{wOuSQNfF_IWdkNf_Jy_o_zLchmK_voumSs_zvoQ_loFyof_FRdiKf_4i4x4NLgDn}

根据 scsfct 对应 moectf ,维吉尼亚密码刚好可以对应出key=goodjob

moectf{vIgENErE_CIphEr_Is_a_lIttlE_hardEr_thaN_caEsar_CIphEr_4u4u4EXfXz}
```
## 喵言喵语
根据hint可知是摩斯密码，以空格位分隔，替换成'/'更直观
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692022446881-616f2127-ee9a-40a5-a500-bee4f77d2f01.png#averageHue=%23eeedeb&clientId=u97f8c1fa-0c2d-4&from=paste&height=303&id=ud530ec8d&originHeight=303&originWidth=1392&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18034&status=done&style=none&taskId=uf2ffb49a-0e46-461a-9390-d416ab2feb0&title=&width=1392)
```
由于第一个分隔前只有' 喵喵？' 将其暂定为' . ' 全部替换

喵喵？/喵喵喵喵喵喵喵喵喵喵喵喵/喵喵喵/喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？/喵喵？喵喵喵喵喵？/喵喵喵喵喵？/喵喵喵喵喵？喵喵？/喵喵喵喵喵？/喵喵喵喵喵喵/喵喵喵喵喵喵/喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？/喵喵？喵喵喵喵喵？喵喵喵/喵喵喵喵喵？/喵喵？/喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？/喵喵？喵喵喵喵喵喵喵喵喵/喵喵喵喵喵喵喵喵？/喵喵？/喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？/喵喵？喵喵喵喵喵喵喵喵喵/喵喵喵/喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？/喵喵？喵喵喵喵喵？喵喵喵/喵喵喵喵喵？/喵喵喵喵喵？喵喵喵喵喵喵/喵喵喵喵喵？喵喵喵喵喵喵/喵喵喵/喵喵？喵喵喵喵喵喵/喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？/喵喵？喵喵？喵喵喵/喵喵？喵喵？喵喵？/喵喵喵喵喵喵喵喵？/喵喵？喵喵？喵喵喵喵喵喵/喵喵喵喵喵喵/喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？/喵喵？喵喵喵喵喵喵喵喵喵/喵喵？喵喵喵喵喵？喵喵？/喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？/喵喵喵喵喵？喵喵喵/喵喵？喵喵喵喵喵喵喵喵？

replace('喵喵？','.')

./喵喵喵喵喵喵喵喵喵喵喵喵/喵喵喵/喵喵喵喵喵喵..喵喵喵./.喵喵喵./喵喵喵./喵喵喵../喵喵喵./喵喵喵喵喵喵/喵喵喵喵喵喵/喵喵喵喵喵喵..喵喵喵./.喵喵喵.喵喵喵/喵喵喵././喵喵喵喵喵喵..喵喵喵./.喵喵喵喵喵喵喵喵喵/喵喵喵喵喵喵././喵喵喵喵喵喵..喵喵喵./.喵喵喵喵喵喵喵喵喵/喵喵喵/喵喵喵喵喵喵..喵喵喵./.喵喵喵.喵喵喵/喵喵喵./喵喵喵.喵喵喵喵喵喵/喵喵喵.喵喵喵喵喵喵/喵喵喵/.喵喵喵喵喵喵/喵喵喵喵喵喵..喵喵喵./..喵喵喵/.../喵喵喵喵喵喵./..喵喵喵喵喵喵/喵喵喵喵喵喵/喵喵喵喵喵喵..喵喵喵./.喵喵喵喵喵喵喵喵喵/.喵喵喵../喵喵喵喵喵喵..喵喵喵./喵喵喵.喵喵喵/.喵喵喵喵喵喵.

莫斯密码肯定有 '-' 又因为不可能是一个'喵'对应一个'-'，后面最短的为'喵喵喵'，将其替换成'-'

replace('喵喵喵','-')

./----/-/--..-./.-./-./-../-./--/--/--..-./.-.-/-././--..-./.---/--././--..-./.---/-/--..-./.-.-/-./-.--/-.--/-/.--/--..-./..-/.../--./..--/--/--..-./.---/.-../--..-./-.-/.--.

Mose Decode: ETRNDNMMNEJGEJTNYYTWUSGMJLKP

发现解出不对，尝试替换'.'为'-'，'-'为'.'

Mose Decode: THE_KAWAII_CAT_BUT_BE_CALLED_GOUZI_BY_RX

moectf{THE_KAWAII_CAT_BUT_BE_CALLED_GOUZI_BY_RX}
```
# 取证
## 随身携带的虚拟机
挂载入 vm 虚拟机，回收站有密钥文件
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692027394130-b03f0dd7-79ea-4e45-981e-7b6c331a6897.png#averageHue=%23faf9f8&clientId=u97f8c1fa-0c2d-4&from=paste&height=550&id=ucef54273&originHeight=550&originWidth=1080&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28694&status=done&style=none&taskId=ueb13a468-5677-4f6d-8e3e-6cad4e27cf7&title=&width=1080)

使用 Recovery Key 解开BitLock 即可得到 flag.txt
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692027458391-7399d42b-eaa0-49da-b963-08b5ed76b0c2.png#averageHue=%23dbb479&clientId=u97f8c1fa-0c2d-4&from=paste&height=688&id=ue1b38e9c&originHeight=688&originWidth=1102&originalType=binary&ratio=1&rotation=0&showTitle=false&size=86547&status=done&style=none&taskId=u2f0fbe10-4c41-44c6-8682-cf89058b5f4&title=&width=1102)

```
bW9lY3Rme0JhczFjX0QxNWtfRjByM25zMWNzIX0=

base64:moectf{Bas1c_D15k_F0r3ns1cs!}
```
## 坚持访问的浏览器
附件打开是 koito 用户文件夹
根据题目的浏览器可知是需要获取浏览器记录，搜索得知 firefox 的浏览记录都存储在 places.sqlite 中，在 Github 上查找相关项目，有个 firefox_history-master 的项目，可以从 places.sqlite 恢复历史记录[https://github.com/vickz84259/firefox_history](https://github.com/vickz84259/firefox_history)

```
执行脚本

 python \firefox_history-master\firefox_history\main.py C:\Users\HK\Desktop\MoeCTF_Forensics_2\Forensics_2\koito\.mozilla\firefox\1xp3jsq0.default-esr\places.sqlite
```
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692023856899-25811374-8025-492a-b7ca-529fc309c005.png#averageHue=%235d5d5d&clientId=u97f8c1fa-0c2d-4&from=paste&height=388&id=ud0199e07&originHeight=388&originWidth=1110&originalType=binary&ratio=1&rotation=0&showTitle=false&size=46442&status=done&style=none&taskId=u5443dc65-577d-4bc4-8300-5dbb156398c&title=&width=1110)

会在目录下生成 final_result

![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692023939570-b155a5f1-0c44-4346-bd61-0c6efef809b5.png#averageHue=%2332302b&clientId=u97f8c1fa-0c2d-4&from=paste&height=165&id=u9a770061&originHeight=165&originWidth=849&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19800&status=done&style=none&taskId=u9d261483-f23a-4593-aa17-a976639dc9a&title=&width=849)

![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692023971714-544b9827-8e05-4f51-a354-bb61ce10b2fb.png#averageHue=%23f3f1f0&clientId=u97f8c1fa-0c2d-4&from=paste&height=190&id=uf70da173&originHeight=190&originWidth=908&originalType=binary&ratio=1&rotation=0&showTitle=false&size=20305&status=done&style=none&taskId=u38e4bdc3-3f6d-4a8c-a42b-b9aeec89049&title=&width=908)

```
moectf{Th15_iS_d3f1ni7e1y_1Ast_0NE_30a13cfb8426e919ecd4c5627cde4fa4}
```
## 锁定起来的同人文
R-studio载入镜像，桌面有一个图片和一个 hc 加密文件
根据图片名 key_pixiv_id105614615.png 下载pixiv id为105614615的原图

![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692024378849-8eaedb40-e02b-4a2d-a319-cef7d91c3e77.png#averageHue=%23ae9274&clientId=u97f8c1fa-0c2d-4&from=paste&height=650&id=ud277107d&originHeight=650&originWidth=837&originalType=binary&ratio=1&rotation=0&showTitle=false&size=219461&status=done&style=none&taskId=uebbc6535-28f2-4518-89a7-a9e957a1da0&title=&width=837)

加载 hc 文件 ，以图片为文件密钥挂载在磁盘上
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692024449118-a58cec2b-3ac1-45fb-b447-87bae5d21f49.png#averageHue=%23ebebeb&clientId=u97f8c1fa-0c2d-4&from=paste&height=489&id=u4633fe7a&originHeight=489&originWidth=569&originalType=binary&ratio=1&rotation=0&showTitle=false&size=46722&status=done&style=none&taskId=uec85542a-51a4-4270-8ca2-10c03403801&title=&width=569)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692024824488-19807cc4-7a43-43b0-a6ee-df42180acacf.png#averageHue=%23fdeec7&clientId=u97f8c1fa-0c2d-4&from=paste&height=138&id=ufe9e9a2f&originHeight=138&originWidth=357&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5619&status=done&style=none&taskId=u747cafbf-e718-4c8d-b282-ef2aa29a976&title=&width=357)
挂载成功后，打开 temp 文件夹有 siyuan.log 搜索的地址是 思源笔记 ，存储笔记在 data 目录下，在 data 目录下翻找

Z:\data\20230707221115-ibr7vs7\20230707221136-xyfn5al\20230707221147-1rzo2wp

将sy文件打开可以看到
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35229002/1692024978218-5240863d-5f5e-4e8b-ac17-1846060aaed0.png#averageHue=%2334332e&clientId=u97f8c1fa-0c2d-4&from=paste&height=1039&id=udf4d150d&originHeight=1039&originWidth=1220&originalType=binary&ratio=1&rotation=0&showTitle=false&size=120461&status=done&style=none&taskId=ub829ece1-2ef1-4afc-8885-56ca697bee9&title=&width=1220)
```
NVXWKY3UMZ5VGMC7MQZTG4DMPFPUQMLEMRSW4IL5

Base32:moectf{S0_d33ply_H1dden!}
```
